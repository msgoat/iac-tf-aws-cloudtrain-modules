# Terraform Module Libary iac-tf-aws-cloudtrain-modules

Terraform multi-module to manage cloud infrastructure on AWS.

Originally developed for msg's `Cloud Training Program` and `Cloud Expert Program`.

> Still work in progress! Provided AS IS without any warranties!

## Module Versioning

This terraform multi-module is versioning via git tags. The main revision number according to semantic versioning 
is stored in file [revision.txt](revision.txt). During the build further parts like branch name and short commit hash
are added to the tag name as well.

So if revision is `1.1.1` and the branch is `main` and the short commit hash is `12345678` the git tag name is `1.1.1.main.12345678`.

Whenever you want to pin the module version used in your terraform live code to a specific version 
like `1.1.1.main.12345678`, add the corresponding tag name to the modules `source` attribute:

```text
module "eks_cluster" {
    source = "git::https://github.com/msgoat/iac-tf-aws-cloudtrain-modules.git//modules/container/eks/cluster?ref=1.1.1.main.12345678"
}
```

## Release Information

A changelog can be found in [changelog.md](changelog.md).

## Status

![Build status](https://codebuild.eu-west-1.amazonaws.com/badges?uuid=eyJlbmNyeXB0ZWREYXRhIjoiaVVHN0Z6b2srYkV5K3lOYVRYbDhDa1FXMlRYWGZ3NnBmYUI0UlczYzVDVXFzei9VTVA1dFI2YjZwbXZGcEtzNE9FMWthaGlpVmo3T3pCdXZJNmNZQnVjPSIsIml2UGFyYW1ldGVyU3BlYyI6IkhvSENJbGYrdHE0NlZRdnEiLCJtYXRlcmlhbFNldFNlcmlhbCI6MX0%3D&branch=main)

## Provided Terraform modules

Provides the following modules:

| Module Name                                                                                                                  | Module Source                                               | Description                                                                                                                                                                                                        |
|------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [compute/ec2/instance-types](modules/compute/ec2/instance-types/README.md)   | modules/compute/ec2/instance-types           | Maps given EC2 instance requirements to concrete EC2 instance types.                                                                                                                                               | 
| [container/eks/addon/aws-ebs-csi-driver](modules/container/eks/addon/aws-ebs-csi-driver/README.md)                           | modules/container/eks/addon/aws-ebs-csi-driver              | Installs the [Amazon EBS CSI driver as an Amazon EKS add-on](https://docs.aws.amazon.com/eks/latest/userguide/managing-ebs-csi.html) on any given AWS EKS cluster.                                                 | 
| [container/eks/addon/cert-manager](modules/container/eks/addon/cert-manager/README.md)                                       | modules/container/eks/addon/cert-manager                    | Installs the [Kubernetes cert-manager](https://cert-manager.io/) on any given AWS EKS cluster.                                                                                                                     | 
| [container/eks/addon/cluster-autoscaler](modules/container/eks/addon/cluster-autoscaler/README.md)                           | modules/container/eks/addon/cluster-autoscaler              | Installs the [Kubernetes Cluster Autoscaler](https://github.com/kubernetes/autoscaler/tree/master/cluster-autoscaler) on any given AWS EKS cluster.                                                                | 
| [container/eks/addon/eck-operator](modules/container/eks/addon/eck-operator/README.md)                                       | modules/container/eks/addon/eck-operator                    | Installs the [Elastic Cloud Kubernetes Operator](https://www.elastic.co/guide/en/cloud-on-k8s/current/k8s-overview.html) as an add-on on the given EKS cluster.                                                    | 
| [container/eks/addon/ingress-aws](modules/container/eks/addon/ingress-aws/README.md)                                         | modules/container/eks/addon/ingress-aws                     | Installs the [AWS Load Balancer Controller](https://docs.aws.amazon.com/eks/latest/userguide/aws-load-balancer-controller.html) as an ingress controller on any given AWS EKS cluster.                             | 
| [container/eks/addon/ingress-nginx](modules/container/eks/addon/ingress-nginx/README.md)                                     | modules/container/eks/addon/ingress-nginx                   | Installs the [NGinX Ingress Controller](https://kubernetes.github.io/ingress-nginx/) as an ingress controller on any given AWS EKS cluster.                                                                        | 
| [container/eks/addon/metrics-server](modules/container/eks/addon/metrics-server/README.md)                                   | modules/container/eks/addon/metrics-server                  | Installs the [Kubernetes Metrics Server](https://github.com/kubernetes-sigs/metrics-server) on any given AWS EKS cluster.                                                                                          | 
| [container/eks/addon/rbac](modules/container/eks/addon/rbac/README.md)                                                       | modules/container/eks/addon/rbac                            | Sets up proper AWS RBAC on a given AWS EKS cluster by changing the `aws-auth` config map.                                                                                                                          | 
| [container/eks/addons](modules/container/eks/addons/README.md)                                                               | modules/container/eks/addons                                | Sets up proper AWS RBAC on a given AWS EKS cluster by changing the `aws-auth` config map.                                                                                                                          | 
| [container/eks/cluster](modules/container/eks/cluster/README.md)                                                             | modules/container/eks/cluster                               | Creates an AWS EKS cluster with EKS-managed node groups                                                                                                                                                            | 
| [container/eks/namespaces](modules/container/eks/namespaces/README.md)                                                       | modules/container/eks/namespaces                            | Creates Kubernetes namespaces with a default behaviour.                                                                                                                                                            | 
| [container/eks/tool/logging/efk-eck-operator](modules/container/eks/tool/logging/efk-eck-operator/README.md)                 | modules/container/eks/tool/logging/efk-eck-operator         | Provisions a cluster tool stack for logging based on `Elasticsearch`, `Fluent Bit` and `Kibana` based on `Elastic Cloud Kubernetes Operator`.                                                                      | 
| [container/eks/tool/monitoring/kube-prometheus-stack](modules/container/eks/tool/monitoring/kube-prometheus-stack/README.md) | modules/container/eks/tool/monitoring/kube-prometheus-stack | Deploys a cluster monitoring stack based on Prometheus Operator using the upstream [kube-prometheus-stack](https://github.com/prometheus-community/helm-charts/tree/main/charts/kube-prometheus-stack) Helm chart. | 
| [container/eks/tool/tracing/jaeger](modules/container/eks/tool/tracing/jaeger/README.md)                                     | modules/container/eks/tool/tracing/jaeger                   | Provisions a tracing toolstack based on Jaeger with ElasticSearch as database.                                                                                                                                     | 
| [container/eks/tools](modules/container/eks/tools/README.md)                                                                 | modules/container/eks/tools                                 | Installs an opinionated set of tool stacks on any given EKS cluster.                                                                                                                                               | 
| [database/elasticsearch/eks](modules/database/elasticsearch/eks/README.md)                                                   | modules/database/elasticsearch/eks                          | Provisions an Elasticsearch cluster on any given AWS EKS cluster.                                                                                                                                                  | 
| [database/postgresql/rds](modules/database/postgresql/rds/README.md)                                                         | modules/database/postgresql/rds                             | Provisions a PostgreSQL instance managed by AWS RDS.                                                                                                                                                               | 
| [dns/hosted-zone](modules/dns/hosted-zone/README.md)                                                                         | modules/dns/hosted-zone                                     | Sets up a Route53 hosted zone.                                                                                                                                                                                     | 
| [dns/record-for-alb](modules/dns/record-for-alb/README.md)                                                                   | modules/dns/record-for-alb                                  | Creates a DNS A alias record representing the given DNS name pointing to the given load balancer.                                                                                                                  | 
| [network/application-loadbalancer](modules/network/application-loadbalancer/README.md)                                       | modules/network/application-loadbalancer                    | Creates an AWS Application Loadbalancer and DNS records for all DNS names pointing to it.                                                                                                                          | 
| [network/vpc-blueprint](modules/network/vpc-blueprint/README.md)                                                             | modules/network/vpc-blueprint                               | Creates a reference VPC based on a VPC blueprint.                                                                                                                                                                  | 
| [network/vpc](modules/network/vpc/README.md)                                                                                 | modules/network/vpc                                         | Creates a VPC spanning the given number of availability zones with the given stack of subnets per availability zone.                                                                                               | 
| [security/certificate](modules/security/certificate/README.md)                                                               | modules/security/certificate                                | Creates a TLS certificate managed by AWS Certificate Manager.                                                                                                                                                      | 
| [serverless/api-gateway](modules/serverless/api-gateway/README.md)                                                           | modules/serverless/api-gateway                              | Creates an AWS API Gateway with routes to Lambda functions.                                                                                                                                                        | 
| [serverless/lambda](modules/serverless/lambda/README.md)                                                                     | modules/serverless/lambda                                   | Creates a Lambda function with sns topic, sqs queue or api gateway as trigger.                                                                                                                                     | 
| [storage/blob](modules/storage/blob/README.md)                                                                               | modules/storage/blob                                        | Creates a S3 bucket supposed to be used for blob storage.                                                                                                                                                          | 
| [terraform/remote-state](modules/terraform/remote-state/README.md)                                                           | modules/terraform/remote-state                  | Creates a Terraform remote backend based on S3 and DynamoDB.                                                                                                                                                       | 
